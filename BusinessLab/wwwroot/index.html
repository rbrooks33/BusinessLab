<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Business Lab</title>
    <!--Ace-->
    <script src="Scripts/Apps/Resources/Ace/ace.js"></script>
    <script src="Scripts/Apps//Resources/Ace/theme-sqlserver.js" type="text/javascript" charset="utf-8"></script>
    <script src="Scripts/Apps/Resources/Ace/mode-sqlserver.js" type="text/javascript" charset="utf-8"></script>
    <script src="Scripts/Apps/Resources/Ace/mode-csharp.js" type="text/javascript" charset="utf-8"></script>

    <!--SignalR-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/6.0.1/signalr.js"></script>

    <!--Font Awesome-->
    <script src="https://kit.fontawesome.com/27d5012c3e.js" crossorigin="anonymous"></script>

    <script>

        var connection = new signalR.HubConnectionBuilder().withUrl("/pushhub").build();

        connection.on("ReceiveMessage", function (result) {

            //TODO: Re-evaluate to see whether or how specific or to use convention
            var params = Enumerable.From(result.params).Where(p => p.name == 'PushName').ToArray();
            if (params.length == 1) {

                let pushValue = params[0].value;

                switch (pushValue) {
                    case 'TestJob': Apps.Components.Helpers.PushHub.Subscriber().Publish('TestJob', result); break;
                }
            }
        });

        connection.start().then(function () {
            //document.getElementById("sendButton").disabled = false;
        }).catch(function (err) {
            return console.error(err.toString());
        });

    </script>

    <!--Apps JS-->
    <script src="Scripts/Apps/Apps.js"></script>
    <script>
        Apps.ComponentsReady = function () {

            //Apps.Notify('success', 'Business Lab is ready!');

            Apps.Components.Helpers.PushHub.Connect();

            Apps.Components.Home.Show();
        }
    </script>

</head>
    <body>

    </body>
</html>